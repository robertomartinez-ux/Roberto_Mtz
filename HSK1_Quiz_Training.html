<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HSK 1 â€“ Quiz</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
}
.card {
  background: white;
  padding: 24px;
  width: 100%;
  max-width: 380px;
  text-align: center;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
button {
  width: 100%;
  padding: 14px;
  margin: 8px 0;
  font-size: 16px;
  cursor: pointer;
  border-radius: 8px;
}
.correct { background:#4CAF50; color:white; }
.wrong { background:#F44336; color:white; }
.char { font-size: 56px; }
.pinyin { color:#555; margin-bottom:10px; }
input {
  width: 100%;
  padding: 14px;
  margin: 8px 0;
  font-size: 16px;
  border-radius: 8px;
  border: 2px solid #ddd;
  box-sizing: border-box;
}

input:focus {
  outline: none;
  border-color: #6c63ff;
}

#nameScreen h3 {
  margin-bottom: 12px;
}
.primary {
  background: #6c63ff;
  color: white;
  border: none;
}
  
</style>
</head>

<body>

<!-- MENU -->
<div class="card" id="menu">
  <h2>HSK 1</h2>

  <h3>ğŸ† Ranking</h3>
  <ul id="ranking" style="list-style:none;padding:0"></ul>
  <hr>

  <button onclick="startGame()">ğŸ® Juego</button>
  <button onclick="chooseSurvival()">ğŸ”¥ Supervivencia</button>
  <button onclick="chooseHard()">ğŸ’€ HARD</button>
</div>

<!-- PEDIR NOMBRE -->
<div class="card" id="nameScreen" style="display:none">
  <h3>ğŸ§‘ Tu nombre</h3>
<input
  id="playerName"
  placeholder="Escribe tu nombre"
  maxlength="12"
  autofocus
  style="width:100%;padding:12px;border-radius:8px;margin-bottom:10px">


  <button class="primary" onclick="confirmName()">Comenzar</button>
  <button onclick="backToMenu()">Cancelar</button>
</div>

<!-- GAME -->
<div class="card" id="game" style="display:none">
  <div id="modeLabel"></div>
  <div id="lives"></div>
  <div id="score">Score: <strong>0</strong></div>

  <div class="char" id="char"></div>
  <div class="pinyin" id="pinyin"></div>

  <div id="options"></div>
  <div id="feedback"></div>

  <button id="exitBtn" onclick="backToMenu()" style="display:none">Salir</button>
</div>

<script type="module">
/* ğŸ”¥ FIREBASE */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, collection, query, orderBy, limit,
  getDocs, addDoc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDp8Pz5wM9qlkpJZrnaVYG2TeHswrp0NP4",
  authDomain: "hsk1quiz.firebaseapp.com",
  projectId: "hsk1quiz",
  storageBucket: "hsk1quiz.firebasestorage.app",
  messagingSenderId: "914453916513",
  appId: "1:914453916513:web:fd0a68a4773c64c1f7f320"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ğŸ† RANKING */
async function loadRanking() {
  const q = query(
    collection(db, "scores"),
    orderBy("score", "desc"),
    limit(3)
  );

  const snapshot = await getDocs(q);
  const ranking = document.getElementById("ranking");
  ranking.innerHTML = "";

  if (snapshot.empty) {
    ranking.innerHTML = "<li>Sin registros aÃºn</li>";
    return;
  }

  const medals = ["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"];
  let pos = 0;

  snapshot.forEach(doc => {
    const { name, score } = doc.data();
    ranking.innerHTML += `<li>${medals[pos]} ${name} - ${score}</li>`;
    pos++;
  });
}


loadRanking();

/* STATE */
let playerName = "";
let mode = "";
let pendingMode = "";
let lives = 3;
let score = 0;
let current;

const words = [
  {c:"çˆ±",p:"Ã i",m:"amar"},{c:"å…«",p:"bÄ",m:"ocho"},{c:"çˆ¸çˆ¸",p:"bÃ ba",m:"papÃ¡"}, {c:"æ¯å­",p:"bÄ“izi",m:"vaso"},{c:"åŒ—äº¬",p:"BÄ›ijÄ«ng",m:"PekÃ­n"}, {c:"æœ¬",p:"bÄ›n",m:"libro / cuaderno"},{c:"ä¸",p:"bÃ¹",m:"no"}, {c:"ä¸å®¢æ°”",p:"bÃº kÃ¨qi",m:"de nada"},{c:"èœ",p:"cÃ i",m:"platillo"}, {c:"èŒ¶",p:"chÃ¡",m:"tÃ©"},{c:"åƒ",p:"chÄ«",m:"comer"}, {c:"å‡ºç§Ÿè½¦",p:"chÅ«zÅ«chÄ“",m:"taxi"},{c:"æ‰“ç”µè¯",p:"dÇ diÃ nhuÃ ",m:"llamar"}, {c:"å¤§",p:"dÃ ",m:"grande"},{c:"çš„",p:"de",m:"posesivo"}, {c:"ç‚¹",p:"diÇn",m:"hora / punto"},{c:"ç”µè„‘",p:"diÃ nnÇo",m:"computadora"}, {c:"ç”µè§†",p:"diÃ nshÃ¬",m:"televisiÃ³n"},{c:"ç”µå½±",p:"diÃ nyÇng",m:"pelÃ­cula"}, {c:"ä¸œè¥¿",p:"dÅngxi",m:"cosa"},{c:"éƒ½",p:"dÅu",m:"todos"}, {c:"è¯»",p:"dÃº",m:"leer"},{c:"å¯¹ä¸èµ·",p:"duÃ¬buqÇ",m:"lo siento"}, {c:"å¤š",p:"duÅ",m:"mucho"},{c:"å¤šå°‘",p:"duÅshao",m:"cuÃ¡nto"}, {c:"å„¿å­",p:"Ã©rzi",m:"hijo"},{c:"äºŒ",p:"Ã¨r",m:"dos"}, {c:"é¥­åº—",p:"fÃ ndiÃ n",m:"restaurante"},{c:"é£æœº",p:"fÄ“ijÄ«",m:"aviÃ³n"}, {c:"åˆ†é’Ÿ",p:"fÄ“nzhÅng",m:"minuto"},{c:"é«˜å…´",p:"gÄoxÃ¬ng",m:"feliz"}, {c:"ä¸ª",p:"gÃ¨",m:"clasificador"},{c:"å·¥ä½œ",p:"gÅngzuÃ²",m:"trabajo"}, {c:"ç‹—",p:"gÇ’u",m:"perro"},{c:"æ±‰è¯­",p:"HÃ nyÇ”",m:"chino"}, {c:"å¥½",p:"hÇo",m:"bueno"},{c:"å·",p:"hÃ o",m:"nÃºmero"}, {c:"å–",p:"hÄ“",m:"beber"},{c:"å’Œ",p:"hÃ©",m:"y"}, {c:"å¾ˆ",p:"hÄ›n",m:"muy"},{c:"åé¢",p:"hÃ²umian",m:"detrÃ¡s"}, {c:"å›",p:"huÃ­",m:"volver"},{c:"ä¼š",p:"huÃ¬",m:"saber / poder"}, {c:"ç«è½¦ç«™",p:"huÇ’chÄ“zhÃ n",m:"estaciÃ³n de tren"}, {c:"å‡ ",p:"jÇ",m:"cuÃ¡ntos"},{c:"å®¶",p:"jiÄ",m:"casa"}, {c:"å«",p:"jiÃ o",m:"llamarse"},{c:"ä»Šå¤©",p:"jÄ«ntiÄn",m:"hoy"}, {c:"ä¹",p:"jiÇ”",m:"nueve"},{c:"å¼€",p:"kÄi",m:"abrir"}, {c:"çœ‹",p:"kÃ n",m:"ver"},{c:"çœ‹è§",p:"kÃ njiÃ n",m:"ver (lograr ver)"}, {c:"å—",p:"kuÃ i",m:"moneda"},{c:"æ¥",p:"lÃ¡i",m:"venir"}, {c:"è€å¸ˆ",p:"lÇoshÄ«",m:"maestro"},{c:"äº†",p:"le",m:"partÃ­cula"}, {c:"å†·",p:"lÄ›ng",m:"frÃ­o"},{c:"é‡Œ",p:"lÇ",m:"dentro"}, {c:"å…­",p:"liÃ¹",m:"seis"},{c:"å¦ˆå¦ˆ",p:"mÄma",m:"mamÃ¡"}, {c:"å—",p:"ma",m:"pregunta"},{c:"ä¹°",p:"mÇi",m:"comprar"}, {c:"çŒ«",p:"mÄo",m:"gato"},{c:"æ²¡",p:"mÃ©i",m:"no (pasado)"}, {c:"æ²¡å…³ç³»",p:"mÃ©i guÄnxi",m:"no pasa nada"}, {c:"ç±³é¥­",p:"mÇfÃ n",m:"arroz"},{c:"åå­—",p:"mÃ­ngzi",m:"nombre"}, {c:"æ˜å¤©",p:"mÃ­ngtiÄn",m:"maÃ±ana"},{c:"å“ª",p:"nÇ",m:"cuÃ¡l"}, {c:"å“ªå„¿",p:"nÇr",m:"dÃ³nde"},{c:"é‚£",p:"nÃ ",m:"ese"}, {c:"é‚£å„¿",p:"nÃ r",m:"allÃ­"},{c:"å‘¢",p:"ne",m:"partÃ­cula"}, {c:"èƒ½",p:"nÃ©ng",m:"poder"},{c:"ä½ ",p:"nÇ",m:"tÃº"}, {c:"å¹´",p:"niÃ¡n",m:"aÃ±o"},{c:"å¥³å„¿",p:"nÇšâ€™Ã©r",m:"hija"}, {c:"æœ‹å‹",p:"pÃ©ngyou",m:"amigo"},{c:"æ¼‚äº®",p:"piÃ oliang",m:"bonito"}, {c:"è‹¹æœ",p:"pÃ­ngguÇ’",m:"manzana"},{c:"ä¸ƒ",p:"qÄ«",m:"siete"}, {c:"é’±",p:"qiÃ¡n",m:"dinero"},{c:"å‰é¢",p:"qiÃ¡nmian",m:"delante"}, {c:"è¯·",p:"qÇng",m:"por favor"},{c:"å»",p:"qÃ¹",m:"ir"}, {c:"çƒ­",p:"rÃ¨",m:"caliente"},{c:"äºº",p:"rÃ©n",m:"persona"}, {c:"è®¤è¯†",p:"rÃ¨nshi",m:"conocer"},{c:"æ—¥",p:"rÃ¬",m:"dÃ­a"}, {c:"ä¸‰",p:"sÄn",m:"tres"},{c:"å•†åº—",p:"shÄngdiÃ n",m:"tienda"}, {c:"ä¸Š",p:"shÃ ng",m:"arriba"},{c:"ä¸Šåˆ",p:"shÃ ngwÇ”",m:"maÃ±ana AM"}, {c:"å°‘",p:"shÇo",m:"poco"},{c:"è°",p:"shÃ©i",m:"quiÃ©n"}, {c:"ä»€ä¹ˆ",p:"shÃ©nme",m:"quÃ©"},{c:"å",p:"shÃ­",m:"diez"}, {c:"æ—¶å€™",p:"shÃ­hou",m:"momento"},{c:"æ˜¯",p:"shÃ¬",m:"ser / estar"}, {c:"ä¹¦",p:"shÅ«",m:"libro"},{c:"æ°´",p:"shuÇ",m:"agua"}, {c:"æ°´æœ",p:"shuÇguÇ’",m:"fruta"},{c:"ç¡è§‰",p:"shuÃ¬jiÃ o",m:"dormir"}, {c:"è¯´",p:"shuÅ",m:"hablar"},{c:"å››",p:"sÃ¬",m:"cuatro"}, {c:"å²",p:"suÃ¬",m:"aÃ±os"},{c:"ä»–",p:"tÄ",m:"Ã©l"}, {c:"å¥¹",p:"tÄ",m:"ella"},{c:"å¤ª",p:"tÃ i",m:"demasiado"}, {c:"å¤©æ°”",p:"tiÄnqÃ¬",m:"clima"},{c:"å¬",p:"tÄ«ng",m:"escuchar"}, {c:"åŒå­¦",p:"tÃ³ngxuÃ©",m:"compaÃ±ero"},{c:"å–‚",p:"wÃ¨i",m:"hola telÃ©fono"}, {c:"æˆ‘",p:"wÇ’",m:"yo"},{c:"æˆ‘ä»¬",p:"wÇ’men",m:"nosotros"}, {c:"äº”",p:"wÇ”",m:"cinco"},{c:"å–œæ¬¢",p:"xÇhuan",m:"gustar"}, {c:"ä¸‹",p:"xiÃ ",m:"abajo"},{c:"ä¸‹åˆ",p:"xiÃ wÇ”",m:"tarde"}, {c:"ä¸‹é›¨",p:"xiÃ yÇ”",m:"llover"},{c:"å…ˆç”Ÿ",p:"xiÄnsheng",m:"seÃ±or"}, {c:"ç°åœ¨",p:"xiÃ nzÃ i",m:"ahora"},{c:"æƒ³",p:"xiÇng",m:"querer / pensar"}, {c:"å°",p:"xiÇo",m:"pequeÃ±o"},{c:"å°å§",p:"xiÇojiÄ›",m:"seÃ±orita"}, {c:"å†™",p:"xiÄ›",m:"escribir"},{c:"è°¢è°¢",p:"xiÃ¨xie",m:"gracias"}, {c:"æ˜ŸæœŸ",p:"xÄ«ngqÄ«",m:"semana"},{c:"å­¦ç”Ÿ",p:"xuÃ©sheng",m:"estudiante"}, {c:"å­¦ä¹ ",p:"xuÃ©xÃ­",m:"estudiar"},{c:"å­¦æ ¡",p:"xuÃ©xiÃ o",m:"escuela"}, {c:"ä¸€",p:"yÄ«",m:"uno"},{c:"è¡£æœ",p:"yÄ«fu",m:"ropa"}, {c:"åŒ»ç”Ÿ",p:"yÄ«shÄ“ng",m:"doctor"},{c:"åŒ»é™¢",p:"yÄ«yuÃ n",m:"hospital"}, {c:"æ¤…å­",p:"yÇzi",m:"silla"},{c:"æœ‰",p:"yÇ’u",m:"tener"}, {c:"æœˆ",p:"yuÃ¨",m:"mes"},{c:"å†è§",p:"zÃ ijiÃ n",m:"adiÃ³s"}, {c:"åœ¨",p:"zÃ i",m:"estar en"},{c:"æ€ä¹ˆ",p:"zÄ›nme",m:"cÃ³mo"}, {c:"æ€ä¹ˆæ ·",p:"zÄ›nmeyÃ ng",m:"quÃ© tal"}, {c:"è¿™",p:"zhÃ¨",m:"este"},{c:"è¿™å„¿",p:"zhÃ¨r",m:"aquÃ­"}, {c:"ä¸­å›½",p:"ZhÅngguÃ³",m:"China"},{c:"ä¸­åˆ",p:"zhÅngwÇ”",m:"mediodÃ­a"}, {c:"ä½",p:"zhÃ¹",m:"vivir"},{c:"æ¡Œå­",p:"zhuÅzi",m:"mesa"}, {c:"å­—",p:"zÃ¬",m:"carÃ¡cter"},{c:"æ˜¨å¤©",p:"zuÃ³tiÄn",m:"ayer"},{c:"5:30",p:"WÇ” diÇn bÃ n",m:"äº”ç‚¹åŠ"} ];

/* SAVE SCORE */
async function saveScore() {
  if (!playerName || score <= 0) return;

  await addDoc(collection(db,"scores"), {
    name: playerName,
    score: score,
    createdAt: serverTimestamp()
  });
}

/* MENU ACTIONS */
window.startGame = () => {
  mode = "game";
  score = 0;
  lives = 999;

  menu.style.display = "none";
  game.style.display = "block";
  modeLabel.innerText = "ğŸ® Juego";
  livesEl.innerText = "";
  scoreEl.innerHTML = "Score: <strong>0</strong>";
  loadWord();
};

window.chooseSurvival = () => {
  pendingMode = "survival";
  menu.style.display = "none";
  nameScreen.style.display = "block";
};

window.chooseHard = () => {
  pendingMode = "hard";
  menu.style.display = "none";
  nameScreen.style.display = "block";
};

window.confirmName = () => {
  const n = playerNameInput.value.trim();
  if (!n) { alert("Escribe tu nombre ğŸ™‚"); return; }

  playerName = n;
  nameScreen.style.display = "none";

  mode = "survival";
  lives = 3;
  score = 0;

  game.style.display = "block";
  modeLabel.innerText = pendingMode === "hard" ? "ğŸ’€ HARD" : "ğŸ”¥ Supervivencia";
  livesEl.innerText = "â¤ï¸â¤ï¸â¤ï¸";
  scoreEl.innerHTML = "Score: <strong>0</strong>";

  loadWord();
};

/* GAME */
function loadWord() {
  current = words[Math.floor(Math.random()*words.length)];
  char.innerText = current.c;
  pinyin.innerText = pendingMode === "hard" ? "" : current.p;

  options.innerHTML = "";
  words.map(w=>w.m).sort(()=>0.5-Math.random()).slice(0,3)
    .concat(current.m).sort(()=>0.5-Math.random())
    .forEach(o=>{
      const b=document.createElement("button");
      b.innerText=o;
      b.onclick=()=>check(o,b);
      options.appendChild(b);
    });
}

function check(ans,btn) {
  if (ans === current.m) {
    btn.className = "correct";
    score++;
  } else {
    btn.className = "wrong";
    lives--;
  }

  scoreEl.innerHTML = `Score: <strong>${score}</strong>`;
  livesEl.innerText = "â¤ï¸".repeat(lives);

if (mode !== "game" && lives === 0) {
  saveScore();
  setTimeout(() => {
    backToMenu();   // ğŸ”¥ vuelve al menÃº y recarga ranking
  }, 800);
  return;
}

  setTimeout(loadWord, 800);
}

/* BACK */
window.backToMenu = () => {
  game.style.display = "none";
  nameScreen.style.display = "none";
  menu.style.display = "block";
  exitBtn.style.display = "none";
  loadRanking();
};

/* DOM */
const menu = document.getElementById("menu");
const nameScreen = document.getElementById("nameScreen");
const game = document.getElementById("game");
const ranking = document.getElementById("ranking");
const char = document.getElementById("char");
const pinyin = document.getElementById("pinyin");
const options = document.getElementById("options");
const scoreEl = document.getElementById("score");
const livesEl = document.getElementById("lives");
const modeLabel = document.getElementById("modeLabel");
const exitBtn = document.getElementById("exitBtn");
const playerNameInput = document.getElementById("playerName");
playerNameInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    confirmName();
  }
});
</script>

</body>
</html>






